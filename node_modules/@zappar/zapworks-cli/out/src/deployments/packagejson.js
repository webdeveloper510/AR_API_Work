"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getPackageConfig = void 0;
const path = require("path");
const fs_1 = require("fs");
const fs_dfs_1 = require("../util/fs-dfs");
async function findPackageJSON() {
    const fileBFS = new fs_dfs_1.default(process.cwd(), ['package.json']);
    const result = await fileBFS.SearchFiles(2);
    return result;
}
async function getPackageConfig() {
    const ret = {
        location: undefined,
        config: {},
    };
    const search = await findPackageJSON();
    if (!search.fileLocation)
        return ret;
    ret.location = search.fileLocation;
    try {
        const contents = await fs_1.promises.readFile(path.join(search.fileLocation, 'package.json'));
        const json = JSON.parse(contents.toString());
        if (!json)
            return ret;
        ret.config.version = json.version || undefined;
    }
    catch (ex) {
    }
    return ret;
}
exports.getPackageConfig = getPackageConfig;
